<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<!-- namespace 비우면 에러 -->
<mapper namespace="com.winter.app.product.ReplyDAO">
	<!-- add -->
	<insert id="setReply" parameterType="ReplyDTO">
		INSERT INTO REPLY
		VALUES (PRODUCT_SEQ.NEXTVAL ,#{productNum},#{userName},#{replyContents}, SYSDATE,#{replyJumsu})
	</insert>

	<!-- list -->
	<select id="getList" parameterType="Map" resultType="ReplyDTO">
		SELECT *
		FROM (SELECT ROWNUM RN, R.* 
			  FROM (SELECT *
					FROM REPLY
					WHERE PRODUCTNUM = #{replyDTO.productNum}
					ORDER BY REPLYNUM DESC) R)
			  WHERE RN BETWEEN #{pager.startRow} AND #{pager.lastRow}
	</select>
	
	<select id="getTotalCount" parameterType="ReplyDTO" resultType="Long">
		SELECT COUNT(REPLYNUM)
		FROM REPLY
		WHERE PRODUCTNUM=#{productNum}
	</select>
	
</mapper>